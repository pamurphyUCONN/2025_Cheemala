Code for Cheemala et al, 2025  Amyotrophic Lateral Sclerosis and Frontotemporal Dementia Mutation Reduces Endothelial TDP-43 and Causes Blood-Brain Barrier Defects.

RNA isolation and analysis

RNA was isolated from sorted or cultured cells by RNA-easy mini or micro columns (Qiagen), with on-column DNAse treatment. RNA was checked for integrity and yield before library preparation (SMART-Seq mRNA LP). Targeted sequencing was 100M 150+150 PE reads on a NovaSeq, and generally yielded more than 100M PE reads per sample. A full list of these datasets is found in SI Table 1 and data is deposited to SRA (PRJNA1054818).

Human and mouse FASTQ were aligned (star/2.7.1a) to hg38 or mm10.  For gene expression analysis the following flags were used: --outFilterMultimapNmax 20 –alignSJoverhangMin 8 –alignSJDBoverhangMin 1 –outFilterMismatchNmax 999 –alignIntronMin 10 –alignIntronMax 1000000 –alignMatesGapMax 1000000 –peOverlapNbasesMin 5. Results were assessed by Qualimap. Transcript counts (rest/1.3.0) was performed using the following parameters –paired-end –calc-ci. 

Differential gene expression was performed by DESeq2 using RSEM-generated gene counts after STAR alignment as described. Output is in SI Table 3. For APAlyzer analysis, we followed the APAlyzer protocol from bam files generated by STAR. Output for primary human brain endothelial cells with and without siTARDBP is in SI Table 4. For splicing analysis by Leafcutter, FASTQ were remapped according to Leafcutter suggested parameters: --twopassMode Basic –alignIntronMin 10 –outSAMstrandField intronMotif. Output was assessed by Qualimap, before analyzing splicing according to Leafcutter protocol.

Gene Set Enrichment Analysis (GSEA) of similarities in gene expression patterns
To examine overlap in gene sets by expression, we used GSEApy. Briefly, we generated pre-ranked lists from our data on experimental deletion or silencing of TDP-43 in human or mouse brain endothelial cells, or from cells of mice with ALS-FTD-associated mutations in Tardbp or Grn. These ranked lists were filtered for BaseMean expression>5, to exclude genes that were not expressed at a sufficient level to be called as differential, and ranked based on Log2 fold-change. We then examined the relative enrichment of MsigDB Hallmark (2020) and KEGG(2021) pathway Gene Sets within the ranked list, using GSEApy parameters “log2 ratio of classes” and “weighted score type 1” with 1000 permutations. These gene sets were mapped to the mouse homologue using BioMart. In addition, we created custom gene sets from our own data, or from publicly available data. The specific datasets used and their parameters are listed in SI Table 6. From these datasets we extracted the most significantly upregulated or downregulated genes, resulting in the generation of two Gene Sets from each perturbation. These custom gene sets were mapped to the mouse homologue using BioMart if derived from human data, and then used in a GSEA search as previously described. Normalized Enrichment Score (NES) and adjusted p-value resulting from these GSEA searches are shown on the associated heatmap. To determine similar pathways, the overlap in pathways is shown in NetworkX, where the overlap between any two data sets is given as the total number of genes in common between the datasets divided by the total number of genes in both datasets (% overlap).  Key enriched pathways were plotted in GSEApy, to show the placement of pathway genes among the up or downregulated transcripts in the datasets.
